# Inference of site specific GTR models

The majority of the steps described below make use of the HPC infrastructure at sciCore of the University of Basel.
Jobs were submitted to a slurm based compute cluster and the corresponding scripts are given here for reference purposes only.

## Simulated data generation

Artifical test data are generated by

	* generating a site specific GTR model by drawing rates for each site from a Gamma distribution and equilibrium frequencies for each site from a Dirichlet distribution.
	* generating a Yule tree with the specified number of leaves
	* simulating sequence evolution along the tree using the GTR model
	* saving the model, alignment, tree, and ancestral sequences for future analysis

These steps are executed using the script `generate_toy_data.py` in the directory `src`.

## Inferring site-specific models
The simulated data are analyzed using the script `reconstruct_toy_data.py`.
This script infers site-specific models using a number of different approaches of varying complexity.
The results are saved in a pickle file for further analysis.

## Reconstructing branch lengths
To compare the ability to correctly infer branch lengths using inferred models, we jointly infer models and branch length.
This step is performed in the script `src/calculate_branch_length.py`.

